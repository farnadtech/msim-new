# ๐ ุงูุฒุงู ุงุญุฑุงุฒ ููุช ุจุฑุง ฺฉุงุฑุจุฑุงู ูุนู

## ุฏู ุฑูุด ุจุฑุง ุงูุฒุงู ุงุญุฑุงุฒ ููุช

### ุฑูุด 1: ููุท ุนูุงูุชโฺฏุฐุงุฑ ุจู ุนููุงู ุงุญุฑุงุฒ ูุดุฏู (ุชูุตู ูโุดูุฏ)

ุงู ุฑูุด ุฏุฑุฎูุงุณุชโูุง KYC ูุจู ุฑุง ุญูุธ ูโฺฉูุฏ ู ููุท ูุถุนุช ฺฉุงุฑุจุฑุงู ุฑุง ุชุบุฑ ูโุฏูุฏ.

**ูุฒุงุง**:
- ุฏุฑุฎูุงุณุชโูุง ูุจู ุญูุธ ูโุดููุฏ
- ุงฺฏุฑ ฺฉุงุฑุจุฑ ูุจูุง KYC ุงุฑุณุงู ฺฉุฑุฏูุ ุงุฏูู ูโุชูุงูุฏ ุขู ุฑุง ุชุงุฏ ฺฉูุฏ
- ุชุงุฑุฎฺู ุญูุธ ูโุดูุฏ

**ุงุฌุฑุง**:
```sql
-- ุฏุฑ Supabase SQL Editor ุงุฌุฑุง ฺฉูุฏ:
-- ูุงู: supabase/mark-all-users-unverified.sql
```

**ูุชุฌู**:
- ุชูุงู ฺฉุงุฑุจุฑุงู ุบุฑ ุงุฏูู `is_verified = false` ูโุดููุฏ
- ุฏุฑุฎูุงุณุชโูุง KYC ูุจู ุจุงู ูโูุงููุฏ
- ฺฉุงุฑุจุฑุงู ุจุงุฏ ููุชุธุฑ ุชุงุฏ ุงุฏูู ุจูุงููุฏ ุง ูุฌุฏุฏุง ุงุฑุณุงู ฺฉููุฏ

---

### ุฑูุด 2: ูพุงฺฉ ฺฉุฑุฏู ฺฉุงูู ู ุดุฑูุน ุงุฒ ุตูุฑ

ุงู ุฑูุด ุชูุงู ุฏุฑุฎูุงุณุชโูุง KYC ูุจู ุฑุง ุญุฐู ูโฺฉูุฏ.

**ูุฒุงุง**:
- ุดุฑูุน ุชูุฒ ุงุฒ ุตูุฑ
- ููู ฺฉุงุฑุจุฑุงู ุจุงุฏ ูุฌุฏุฏุง KYC ุงุฑุณุงู ฺฉููุฏ

**ูุนุงุจ**:
- ุชุงุฑุฎฺู ุงุฒ ุจู ูโุฑูุฏ
- ุฏุฑุฎูุงุณุชโูุง ูุจู ุญุฐู ูโุดููุฏ

**ุงุฌุฑุง**:
```sql
-- ุฏุฑ Supabase SQL Editor ุงุฌุฑุง ฺฉูุฏ:
-- ูุงู: supabase/reset-all-users-kyc-status.sql
```

**ูุชุฌู**:
- ุชูุงู ฺฉุงุฑุจุฑุงู ุบุฑ ุงุฏูู `is_verified = false` ูโุดููุฏ
- ุชูุงู ุฏุฑุฎูุงุณุชโูุง KYC ูุจู ุญุฐู ูโุดููุฏ
- ฺฉุงุฑุจุฑุงู ุจุงุฏ ุงุฒ ุตูุฑ ุดุฑูุน ฺฉููุฏ

---

## ูุฑุงุญู ุงุฌุฑุง (ุฑูุด ุชูุตู ุดุฏู)

### ูุฑุญูู 1: Backup ุจฺฏุฑุฏ
```sql
-- Backup ุงุฒ ุฌุฏูู users
CREATE TABLE users_backup AS SELECT * FROM users;

-- Backup ุงุฒ ุฌุฏูู kyc_verifications
CREATE TABLE kyc_verifications_backup AS SELECT * FROM kyc_verifications;
```

### ูุฑุญูู 2: ุงุฌุฑุง ุงุณฺฉุฑูพุช
1. ุจู Supabase Dashboard ุจุฑูุฏ
2. SQL Editor ุฑุง ุจุงุฒ ฺฉูุฏ
3. ูุญุชูุง `supabase/mark-all-users-unverified.sql` ุฑุง ฺฉูพ ฺฉูุฏ
4. ุฏุฑ SQL Editor ูพุณุช ฺฉูุฏ
5. "Run" ฺฉูุฏ

### ูุฑุญูู 3: ุจุฑุฑุณ ูุชุฌู
```sql
-- ุจุฑุฑุณ ูุถุนุช ฺฉุงุฑุจุฑุงู
SELECT 
    role,
    COUNT(*) as total,
    SUM(CASE WHEN is_verified = true THEN 1 ELSE 0 END) as verified,
    SUM(CASE WHEN is_verified = false THEN 1 ELSE 0 END) as unverified
FROM users
GROUP BY role;
```

**ุงูุชุธุงุฑ**:
- ุงุฏููโูุง: verified
- ุฎุฑุฏุงุฑุงู ู ูุฑูุดูุฏฺฏุงู: unverified

### ูุฑุญูู 4: ูุนุงู ฺฉุฑุฏู ุชูุธูุงุช KYC
1. ูุงุฑุฏ ูพูู ุงุฏูู ุดูุฏ
2. ุจู ุชูุธูุงุช ุจุฑูุฏ
3. ุฏุณุชู "ุงุญุฑุงุฒ ููุช" ุฑุง ุจุงุฒ ฺฉูุฏ
4. ุชูุธูุงุช ุฑุง ูุนุงู ฺฉูุฏ:
   - `kyc_required` = true
   - `kyc_required_for_sellers` = true
   - `kyc_required_for_buyers` = true

---

## ฺู ุงุชูุงู ุจุฑุง ฺฉุงุฑุจุฑุงู ูโุงูุชุฏุ

### ฺฉุงุฑุจุฑุงู ฺฉู ูุจูุง KYC ุงุฑุณุงู ฺฉุฑุฏูโุงูุฏ:
1. ูุถุนุช ุขูโูุง `is_verified = false` ูโุดูุฏ
2. ุฏุฑุฎูุงุณุช KYC ุขูโูุง ุฏุฑ ุณุณุชู ุจุงู ูโูุงูุฏ
3. ููุช ูุงุฑุฏ ุณุงุช ุดููุฏุ ูพุงู "ุฏุฑ ุงูุชุธุงุฑ ุจุฑุฑุณ" ูโุจููุฏ
4. ุงุฏูู ูโุชูุงูุฏ ุฏุฑุฎูุงุณุช ูุจู ุขูโูุง ุฑุง ุชุงุฏ ฺฉูุฏ
5. ูพุณ ุงุฒ ุชุงุฏุ ุฏุณุชุฑุณ ฺฉุงูู ูพุฏุง ูโฺฉููุฏ

### ฺฉุงุฑุจุฑุงู ฺฉู ูููุฒ KYC ุงุฑุณุงู ูฺฉุฑุฏูโุงูุฏ:
1. ูุถุนุช ุขูโูุง `is_verified = false` ุงุณุช
2. ููุช ูุงุฑุฏ ุณุงุช ุดููุฏุ ุจู ุตูุญู KYC ูุฏุงุช ูโุดููุฏ
3. ุจุงุฏ ูุฑู ุฑุง ูพุฑ ฺฉููุฏ ู ูุฏุงุฑฺฉ ุขูพููุฏ ฺฉููุฏ
4. ููุชุธุฑ ุชุงุฏ ุงุฏูู ูโูุงููุฏ
5. ูพุณ ุงุฒ ุชุงุฏุ ุฏุณุชุฑุณ ฺฉุงูู ูพุฏุง ูโฺฉููุฏ

### ุงุฏููโูุง:
- ูฺ ุชุบุฑ ููโฺฉููุฏ
- ููฺูุงู ุฏุณุชุฑุณ ฺฉุงูู ุฏุงุฑูุฏ
- ูุงุฒ ุจู KYC ูุฏุงุฑูุฏ

---

## ุจุงุฒฺฏุดุช ุจู ุญุงูุช ูุจู (ุฏุฑ ุตูุฑุช ูุงุฒ)

ุงฺฏุฑ ูโุฎูุงูุฏ ุชุบุฑุงุช ุฑุง ุจุฑฺฏุฑุฏุงูุฏ:

```sql
-- ุจุงุฒฺฏุดุช ุงุฒ Backup
UPDATE users u
SET 
    is_verified = b.is_verified,
    kyc_submitted_at = b.kyc_submitted_at
FROM users_backup b
WHERE u.id = b.id;

-- ุญุฐู Backup
DROP TABLE users_backup;
DROP TABLE kyc_verifications_backup;
```

---

## ุขูุงุฑ ู ฺฏุฒุงุฑุด

### ุชุนุฏุงุฏ ฺฉุงุฑุจุฑุงู ุงุญุฑุงุฒ ูุดุฏู:
```sql
SELECT COUNT(*) FROM users 
WHERE role != 'admin' AND is_verified = false;
```

### ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุชโูุง KYC ุฏุฑ ุงูุชุธุงุฑ:
```sql
SELECT COUNT(*) FROM kyc_verifications 
WHERE status = 'pending';
```

### ูุณุช ฺฉุงุฑุจุฑุงู ุงุญุฑุงุฒ ูุดุฏู:
```sql
SELECT id, name, role, phoneNumber, created_at
FROM users
WHERE role != 'admin' AND is_verified = false
ORDER BY created_at DESC;
```

---

## ูฺฉุงุช ููู

### โ๏ธ ูุจู ุงุฒ ุงุฌุฑุง:
- ุญุชูุง Backup ุจฺฏุฑุฏ
- ุฏุฑ ุณุงุนุงุช ฺฉู ฺฉุงุฑุจุฑ ุงุฌุฑุง ฺฉูุฏ
- ุจู ฺฉุงุฑุจุฑุงู ุงุทูุงุน ุฏูุฏ

### โ ูพุณ ุงุฒ ุงุฌุฑุง:
- ุขูุงุฑ ุฑุง ุจุฑุฑุณ ฺฉูุฏ
- ุจู ูพูู KYC ุจุฑูุฏ ู ุฏุฑุฎูุงุณุชโูุง ุฑุง ุจุจูุฏ
- ุจู ฺฉุงุฑุจุฑุงู ฺฉูฺฉ ฺฉูุฏ

### ๐ก ุชูุตูโูุง:
- ุงุฒ ุฑูุด 1 ุงุณุชูุงุฏู ฺฉูุฏ (ุญูุธ ุฏุฑุฎูุงุณุชโูุง ูุจู)
- ุจู ฺฉุงุฑุจุฑุงู ุฒูุงู ฺฉุงู ุจุฏูุฏ
- ุฏุฑุฎูุงุณุชโูุง ุฑุง ุณุฑุน ุจุฑุฑุณ ฺฉูุฏ
- ูพุดุชุจุงู ุขูุงุฏู ุจุงุดุฏ

---

## ูพุดุชุจุงู

ุงฺฏุฑ ูุดฺฉู ูพุด ุขูุฏ:
1. ุงุฒ Backup ุจุงุฒฺฏุฑุฏุงู ฺฉูุฏ
2. ูุงฺฏโูุง ุฑุง ุจุฑุฑุณ ฺฉูุฏ
3. ุจู ูุณุชูุฏุงุช ูุฑุงุฌุนู ฺฉูุฏ

---

**โ ุขูุงุฏู ุงุฌุฑุง!**
