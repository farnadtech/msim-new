# ๐จ ุณุณุชู ุชุนูู ู ูููุช ูุนุงูโุณุงุฒ

## ๐ ุฎูุงุตู ุณุณุชู

ุงู ุณุณุชู ุดุงูู ููุงุฑุฏ ุฒุฑ ุงุณุช:

### 1. โฐ ุชุงูุฑ ุญุฐู ุฎูุฏฺฉุงุฑ ุขฺฏูโูุง
- ูุฑ ุขฺฏู ุจุฑ ุงุณุงุณ ุชูุธูุงุช (`listing_max_duration_days`) ุชุงุฑุฎ ุงููุถุง ุฏุงุฑุฏ
- ุชุงูุฑ ุฏุฑ ุตูุญู "ุณูฺฉุงุฑุชโูุง ูู" ูุฑูุดูุฏู ููุงุด ุฏุงุฏู ูโุดูุฏ
- ุขฺฏูโูุง ูููุถ ุดุฏู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุญุฐู ูโุดููุฏ

### 2. โ ูููุช 48 ุณุงุนุชู ูุนุงูโุณุงุฒ ุฎุท
- ูุฑูุดูุฏู ูพุณ ุงุฒ ูุฑูุด ุจุงุฏ ุธุฑู 48 ุณุงุนุช ุฎุท ุฑุง ูุนุงู ฺฉูุฏ
- ุชุงูุฑ ุฏุฑ ูพููโูุง "ุฎุทูุท ุตูุฑ" ู "ุฎุทูุท ูุนุงู" ููุงุด ุฏุงุฏู ูโุดูุฏ
- ุงุนูุงู ุดุฏู ุจุฑุง ุชูุงู ุงููุงุน ูุฑูุด (ุญุฑุงุฌุ ูพุฑุฏุงุฎุช ุงููุ ููุช ูุงุทุน)

### 3. โ ูุบู ุฎูุฏฺฉุงุฑ ูุนุงููู
- ุงฺฏุฑ ูุฑูุดูุฏู ุฏุฑ 48 ุณุงุนุช ุฎุท ุฑุง ูุนุงู ูฺฉูุฏุ ูุนุงููู ูุบู ูโุดูุฏ
- ูพูู ุจู ุญุณุงุจ ูุงุจู ุจุฑุฏุงุดุช ุฎุฑุฏุงุฑ ููุชูู ูโุดูุฏ
- ุจู ูุฑูุดูุฏู ุงุนูุงู ุฏุงุฏู ูโุดูุฏ

### 4. โ๏ธ ุณุณุชู ุงูุชุงุฒ ููู
- ูุฑ ุจุงุฑ ุนุฏู ูุนุงูโุณุงุฒ = +1 ุงูุชุงุฒ ููู
- ุงูุชุงุฒ ููู ุฏุฑ ูพุฑููุงู ูุฑูุดูุฏู ุซุจุช ูโุดูุฏ
- ุงุฏูู ูโุชูุงูุฏ ฺฉุงุฑุจุฑุงู ุจุง ุงูุชุงุฒ ููู ุฑุง ุจุจูุฏ

### 5. ๐ ุณุณุชู ุชุนูู ุญุณุงุจ
- ุงุฏูู ูโุชูุงูุฏ ุญุณุงุจ ฺฉุงุฑุจุฑุงู ุฑุง ุชุนูู ฺฉูุฏ
- ฺฉุงุฑุจุฑุงู ุชุนูู ุดุฏู ููโุชูุงููุฏ ูุงุฑุฏ ูพูู ุฎูุฏ ุดููุฏ
- ููุท ุตูุญู ุฏุฑุฎูุงุณุช ุฑูุน ุชุนูู ุฑุง ูโุจููุฏ

### 6. ๐ ุฏุฑุฎูุงุณุช ุฑูุน ุชุนูู
- ฺฉุงุฑุจุฑุงู ูโุชูุงููุฏ ุฏุฑุฎูุงุณุช ุฑูุน ุชุนูู ุงุฑุณุงู ฺฉููุฏ
- ุงุฏูู ุฏุฑุฎูุงุณุชโูุง ุฑุง ูโุจูุฏ ู ุชุตูู ูโฺฏุฑุฏ
- ุงุฏูู ูโุชูุงูุฏ ูพุงุณุฎ ุจุฏูุฏ ู ุชุนูู ุฑุง ุฑูุน ฺฉูุฏ

---

## ๐ฆ ูุงูโูุง ุงุฌุงุฏ ุดุฏู

### 1. Migration SQL
- `supabase/add-suspension-system.sql` - ุงุฌุงุฏ ุฌุฏุงูู ู ููุฏูุง ุฌุฏุฏ

### 2. Types
- ุงูุฒูุฏู ููุฏูุง ุฌุฏุฏ ุจู `User`, `SimCard`, `PurchaseOrder`
- ุงูุฒูุฏู `SuspensionRequest` type

### 3. Components
- `components/CountdownTimer.tsx` - ฺฉุงููพูููุช ุชุงูุฑ ุดูุงุฑุด ูุนฺฉูุณ

### 4. Hooks
- `hooks/useActivationDeadlineChecker.ts` - ุจุฑุฑุณ ู ูุบู ุฎูุฏฺฉุงุฑ ุณูุงุฑุดโูุง ูููุถ ุดุฏู

### 5. Pages
- `pages/SuspendedAccountPage.tsx` - ุตูุญู ุชุนูู ุจุฑุง ฺฉุงุฑุจุฑุงู

---

## ๐ง ูุงูโูุง ูุงุฒ ุจู ุชุบุฑ

### 1. `App.tsx`
```typescript
import useActivationDeadlineChecker from './hooks/useActivationDeadlineChecker';
import SuspendedAccountPage from './pages/SuspendedAccountPage';

// ุฏุฑ AppContent component
useActivationDeadlineChecker(); // ุงุถุงูู ฺฉุฑุฏู hook

// ุฏุฑ Routes
<Route path="/suspended" element={<SuspendedAccountPage />} />
```

### 2. `contexts/AuthContext-supabase.tsx`
```typescript
// ุฏุฑ login/signup: ุจุฑุฑุณ ุงูฺฉู ุขุง ฺฉุงุฑุจุฑ ุชุนูู ุดุฏู ุงุณุช
if (userData.is_suspended) {
  navigate('/suspended');
  return;
}
```

### 3. `pages/SellerDashboard.tsx` - ุฏุฑ MySimCards
```typescript
import CountdownTimer from '../components/CountdownTimer';

// ุฏุฑ ุฌุฏูู ุณูฺฉุงุฑุชโูุง
<th className="p-3">ุฒูุงู ุจุงูโูุงูุฏู</th>

// ุฏุฑ tbody
<td className="p-3">
  {sim.expiry_date ? (
    <CountdownTimer targetDate={sim.expiry_date} />
  ) : (
    'ูุงูุญุฏูุฏ'
  )}
</td>
```

### 4. `pages/SellerDashboard.tsx` - ุฏุฑ SellerInactiveOrdersPanel ู SellerActiveOrdersPanel
```typescript
import CountdownTimer from '../components/CountdownTimer';

// ุจุฑุง ูุฑ ุณูุงุฑุด
{order.activation_deadline && (
  <div className="mt-2">
    <span className="text-sm font-medium">ุฒูุงู ุจุงูโูุงูุฏู: </span>
    <CountdownTimer 
      targetDate={order.activation_deadline}
      onExpire={() => {
        // ุฑูุฑุด ุฏุงุฏูโูุง
        fetchData();
      }}
    />
  </div>
)}
```

### 5. `pages/AdminDashboard.tsx` - ูพูู ูุฏุฑุช ุชุนููโูุง
```typescript
// Route ุฌุฏุฏ
<Route path="suspensions" element={<AdminSuspensionsPanel />} />
<Route path="suspension-requests" element={<AdminSuspensionRequestsPanel />} />

// ุฏุฑ NavItem
<NavItem to="suspensions">ูุฏุฑุช ุชุนููโูุง</NavItem>
<NavItem to="suspension-requests">ุฏุฑุฎูุงุณุชโูุง ุฑูุน ุชุนูู</NavItem>
```

---

## ๐ฏ ูุงูโูุง ุจุงุฏ ุงุฌุงุฏ ุดููุฏ

### 1. `components/AdminSuspensionsPanel.tsx`
ูพูู ุจุฑุง:
- ููุงุด ูุณุช ฺฉุงุฑุจุฑุงู ุจุง ุงูุชุงุฒ ููู
- ุชุนูู/ุฑูุน ุชุนูู ฺฉุงุฑุจุฑุงู
- ูุดุงูุฏู ุชุงุฑุฎฺู ุฌุฑููโูุง

### 2. `components/AdminSuspensionRequestsPanel.tsx`
ูพูู ุจุฑุง:
- ููุงุด ุฏุฑุฎูุงุณุชโูุง ุฑูุน ุชุนูู
- ูพุงุณุฎ ุฏุงุฏู ุจู ุฏุฑุฎูุงุณุชโูุง
- ุชุงุฏ/ุฑุฏ ุฏุฑุฎูุงุณุช ุฑูุน ุชุนูู

---

## ๐๏ธ ุชุบุฑุงุช ุฏุชุงุจุณ

### ุฌุฏูู `users`
```sql
- is_suspended BOOLEAN
- suspended_at TIMESTAMP
- suspension_reason TEXT
- negative_score INTEGER
- last_penalty_at TIMESTAMP
```

### ุฌุฏูู `sim_cards`
```sql
- created_at TIMESTAMP
- expiry_date TIMESTAMP
```

### ุฌุฏูู `purchase_orders`
```sql
- activation_deadline TIMESTAMP
- is_cancelled BOOLEAN
- cancellation_reason TEXT
- cancelled_at TIMESTAMP
```

### ุฌุฏูู ุฌุฏุฏ `suspension_requests`
```sql
- id SERIAL PRIMARY KEY
- user_id UUID
- message TEXT
- status VARCHAR(20)
- admin_response TEXT
- created_at TIMESTAMP
- updated_at TIMESTAMP
- reviewed_by UUID
- reviewed_at TIMESTAMP
```

---

## ๐ ูุฑุงุญู ูพุงุฏูโุณุงุฒ

### ูุฑุญูู 1: ุงุฌุฑุง Migration
```sql
-- ุฏุฑ Supabase SQL Editor
ุงุฌุฑุง ูุงู: supabase/add-suspension-system.sql
```

### ูุฑุญูู 2: ุชุณุช ุชุงูุฑูุง
1. ุงุฌุงุฏ ฺฉ ุขฺฏู ุฌุฏุฏ
2. ุจุฑุฑุณ ููุงุด ุชุงูุฑ ุฏุฑ "ุณูฺฉุงุฑุชโูุง ูู"
3. ุงุฌุงุฏ ฺฉ ุณูุงุฑุด ุฎุฑุฏ
4. ุจุฑุฑุณ ููุงุด ุชุงูุฑ ุฏุฑ "ุฎุทูุท ุตูุฑ"

### ูุฑุญูู 3: ุชุณุช ุณุณุชู ุฌุฑูู
1. ููุชุธุฑ ูุงูุฏู ุชุง 48 ุณุงุนุช ุณูพุฑ ุดูุฏ (ุง ุชุบุฑ ุฏุณุช `activation_deadline`)
2. ุจุฑุฑุณ ูุบู ุฎูุฏฺฉุงุฑ ุณูุงุฑุด
3. ุจุฑุฑุณ ุจุงุฒฺฏุดุช ูพูู ุจู ุฎุฑุฏุงุฑ
4. ุจุฑุฑุณ ุงุถุงูู ุดุฏู ุงูุชุงุฒ ููู ุจู ูุฑูุดูุฏู

### ูุฑุญูู 4: ุชุณุช ุณุณุชู ุชุนูู
1. ุชุนูู ฺฉุฑุฏู ฺฉ ฺฉุงุฑุจุฑ ุชูุณุท ุงุฏูู
2. ูุฑูุฏ ฺฉุงุฑุจุฑ ู ุจุฑุฑุณ ููุงุด ุตูุญู ุชุนูู
3. ุงุฑุณุงู ุฏุฑุฎูุงุณุช ุฑูุน ุชุนูู
4. ุจุฑุฑุณ ุฏุฑุฎูุงุณุช ุชูุณุท ุงุฏูู
5. ุฑูุน ุชุนูู ู ูุฑูุฏ ูุฌุฏุฏ ฺฉุงุฑุจุฑ

---

## โก ูฺฉุงุช ููู

1. **Performance**: Hook ุจุฑุฑุณ ูููุช ูุฑ 5 ุฏููู ุงุฌุฑุง ูโุดูุฏ
2. **Notifications**: ุงุนูุงูโูุง ุฎูุฏฺฉุงุฑ ุจุฑุง ุฎุฑุฏุงุฑ ู ูุฑูุดูุฏู ุงุฑุณุงู ูโุดูุฏ
3. **Settings**: ูุฏุช ุฒูุงูโูุง ุงุฒ `site_settings` ุฎูุงูุฏู ูโุดูุฏ
4. **RLS**: Policy ูุง ุงููุช ุจุฑุง ุชูุงู ุฌุฏุงูู ุฌุฏุฏ ุชูุธู ุดุฏู ุงุณุช

---

## ๐จ UI/UX

### ุชุงูุฑ ุฑูฺฏโุจูุฏ
- **ุณุจุฒ**: ุจุด ุงุฒ 24 ุณุงุนุช ุจุงููุงูุฏู
- **ุฒุฑุฏ**: 6 ุชุง 24 ุณุงุนุช
- **ูุฑูุฒ**: ฺฉูุชุฑ ุงุฒ 6 ุณุงุนุช
- **ูุฑูุฒ ูพุฑุฑูฺฏ**: ูููุถ ุดุฏู

### ุตูุญู ุชุนูู
- ุทุฑุงุญ ุฌุฐุงุจ ุจุง ฺฏุฑุงุฏุงูุช ูุฑูุฒ
- ููุงุด ุฏูู ุชุนูู
- ูุฑู ุฏุฑุฎูุงุณุช ุฑูุน ุชุนูู
- ุฏฺฉูู ุฎุฑูุฌ

---

## ๐ ุงููุช

- ุชูุงู ุนููุงุช ุญุณุงุณ ุชูุณุท RLS ูุญุงูุธุช ูโุดููุฏ
- ููุท ุงุฏูู ูโุชูุงูุฏ ฺฉุงุฑุจุฑุงู ุฑุง ุชุนูู ฺฉูุฏ
- ฺฉุงุฑุจุฑุงู ููุท ุฏุฑุฎูุงุณุชโูุง ุฎูุฏ ุฑุง ูโุจููุฏ
- ุงุฏูู ุชูุงู ุฏุฑุฎูุงุณุชโูุง ุฑุง ูโุจูุฏ

---

## โ ฺฺฉ ูุณุช ููุง

- [x] Migration SQL
- [x] Types
- [x] CountdownTimer component
- [x] useActivationDeadlineChecker hook
- [x] SuspendedAccountPage
- [ ] AdminSuspensionsPanel component
- [ ] AdminSuspensionRequestsPanel component
- [ ] ุชุบุฑุงุช App.tsx
- [ ] ุชุบุฑุงุช AuthContext
- [ ] ุชุบุฑุงุช SellerDashboard (ุชุงูุฑูุง)
- [ ] ุชุบุฑุงุช AdminDashboard (ุฑูุชโูุง)
- [ ] ุชุณุช ฺฉุงูู ุณุณุชู

---

**ูฺฉุชู**: ุงู ฺฉ ุณุณุชู ูพฺุฏู ุงุณุช. ุชูุตู ูโุดูุฏ ูุฑ ุจุฎุด ุฑุง ุฌุฏุงฺฏุงูู ุชุณุช ฺฉูุฏ ูุจู ุงุฒ ุงูุชูุงู ุจู production.
